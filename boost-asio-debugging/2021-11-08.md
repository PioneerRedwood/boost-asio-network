# 2021-11-08 디버깅 일지

### Concurrency programming 동시성 프로그래밍 - mutex

멀티 스레드로 동작하는 프로그램에선 리소스에 접근하는 것을 관리해야 한다. 만약 여러 스레드가 하나의 리소스를 쓰기 동작을 하려고 할 때 서로 수행하기 위해 무한정 대기상태에 빠지거나(데드락), 리소스가 변경돼버린 것을 읽는 잘못된 행동을 초래할 수 있기 때문이다. 동시다발적으로 발생 가능한 명령을 처리하기 위해 프로그래밍 언어에서 다양한 방법의 해결책을 제시한다. C++에서는 상호배제(mutex, MUTual EXclusion)를 표준 라이브러리에 추가했다. 

초기 설계 시 최대한 데이터를 두고 경쟁하는 상태가 벌어지지 않도록 하는 것도 중요하지만 멀티 스레드로 동작할 때 어떤 상황이 벌어질지 예측하는 것은 쉽지 않으며 발생 가능성이 1%라도 존재한다면 그에 대한 마땅한 해결책을 제시해야 한다. 특히 MMORPG를 서비스하는 등의 대형 서버를 동작하기 위해선 멀티 스레드는 필수이며 공유 데이터를 사용하는 일 역시 불가피하기 때문에 많은 프로젝트에서 mutex을 사용한다. 

경험해본 것은 C++17 std::scoped_lock과 자체적으로 만든 Spinlock을 봤다. 어느 상황에서 쓰이느냐에 따라 다르겠지만 어떠한 선택이 옳은지(?) [스택오버플로우에서 이에 대한 토론](https://stackoverflow.com/questions/5869825/when-should-one-use-a-spinlock-instead-of-mutex)을 찾을 수 있었다. 

주관적인 결론으로 어떤 것이 정답인지 알 수 없기 때문에 둘을 여러가지 상황에 맞게 테스트를 진행해본 뒤에 도입하는 것으로 도출됐다.



#### win-iocp 스터디 프로젝트 시작

- https://github.com/zeliard/GSP
